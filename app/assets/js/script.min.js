var app={}||app;!function(){"use strict";var e,t=jQuery;app.initMap=function(){var t,a;a=document.getElementById("map"),t=[{elementType:"geometry",stylers:[{color:"#7a757b"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#d7c2d2"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#f0e9ee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d3ccd5"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#3c5842"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#669a5c"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ca9bd2"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#352937"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#dbdddd"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#d48dc2"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#9b8d9c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#8d7985"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#a18a98"}]}],e=new google.maps.Map(a,{center:{lat:50.467859,lng:-116.266224},zoom:7,mapTypeControl:!1,styles:t});var l=[{place_id:"ChIJ_f9-6SYGelMRaZ4lDCFImk4",title:"Kootenay National Park",location:{lat:50.9769367,lng:-115.9592102}},{place_id:"ChIJyaLFSj48eVMRc4lvx8rhwJ0",title:"Two Lakes In Revelstoke National Park",location:{lat:51.0336631,lng:-118.1640469}},{place_id:"ChIJlZGSjCtmd1MR5tfKrGjincA",title:"Banff National Park",location:{lat:51.4968464,lng:-115.9280562}},{place_id:"ChIJxWd-JkUIeVMRuQ7amxSgRPA",title:"Glacier National Park of Canada",location:{lat:51.335289,lng:-117.5297595}},{place_id:"ChIJv0mRixFDb1MRHFgDVHceYN8",title:"Waterton Lakes National Park",location:{lat:49.0833333,lng:-113.9166667}}],i=new o(l);ko.applyBindings(i)};var a=function(e){this.placeId=ko.observable(e.place_id),this.title=ko.observable(e.title),this.location=ko.observable(e.location),this.marker=ko.observable(),this.description=ko.observable(e.description),this.itemActive=ko.observable(!1)},o=function(o){function l(e){var t=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return t}var i,r,s=this,n=new google.maps.InfoWindow;r=l("0091ff"),s.sidebarActiveClass="active",s.filterInput=ko.observable(""),s.placesList=ko.observableArray([]),s.visiblePlacesList=ko.observableArray(),s.toggleSidebar=ko.observable(!1),o.forEach(function(e){s.placesList.push(new a(e))}),s.placesList().forEach(function(e){s.visiblePlacesList.push(e)}),s.placesList().forEach(function(a){i=new google.maps.Marker({position:new google.maps.LatLng(a.location().lat,a.location().lng),map:e,animation:google.maps.Animation.DROP,icon:r}),a.marker=i;var o="http://en.wikipedia.org/w/api.php?action=opensearch&search="+a.title()+"&format=json&callback=wikiCallback";t.ajax({url:o,dataType:"jsonp",jsonp:"callback",success:function(t){var o=t[2][0]||"Description not found";a.description(o);var l='<div class="info-window"><h4 class="info-window__title">'+a.title()+'</h4><p class="info-window__description">'+a.description()+"</p></div>";google.maps.event.addListener(a.marker,"click",function(){n.open(e,this),this.setAnimation(google.maps.Animation.DROP),n.setContent(l),e.setCenter(a.marker.getPosition())})},error:function(){n.setContent("<p>Failed to get Wikipedia resources</p>"),document.getElementById("error-message").innerHTML="<p>Failed to get Wikipedia resources</p>"}})}),s.showPlaceDescription=function(e){google.maps.event.trigger(e.marker,"click"),ko.utils.arrayForEach(s.visiblePlacesList(),function(t){t.itemActive(t.placeId()===e.placeId())})},s.toggleSidebarHandler=function(){s.toggleSidebar()?s.toggleSidebar(!1):s.toggleSidebar(!0)},s.filterMarkers=function(){var e=s.filterInput().toLowerCase();s.visiblePlacesList.removeAll(),s.placesList().forEach(function(t){t.marker.setVisible(!1),t.title().toLowerCase().indexOf(e)!==-1&&s.visiblePlacesList.push(t)}),s.visiblePlacesList().forEach(function(e){e.marker.setVisible(!0)})}}}();